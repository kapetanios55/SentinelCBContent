{
  "id": "64ef63bd-572d-4081-810c-2b6d35fbd61a",
  "name": "Hunting - SolarWinds WHD Deserialization RCE Indicators (CVE-2025-40551)",
  "description": "Proactive threat hunt for indicators of SolarWinds Web Help Desk deserialization RCE exploitation (CVE-2025-40551). This unauthenticated vulnerability allows remote code execution via Java deserialization in the WHD application. Hunt covers: (1) large or typed POST requests to WHD endpoints suggesting serialized Java object delivery, (2) WHD Java/Tomcat processes spawning shells or download tools, (3) outbound C2 callbacks from WHD Java processes, and (4) lateral movement from the WHD server post-compromise. Lookback: 30 days.",
  "tactics": [
    "InitialAccess",
    "Execution",
    "Persistence"
  ],
  "techniques": [
    "T1190",
    "T1059",
    "T1078"
  ],
  "requiredDataConnectors": [
    "MicrosoftDefenderForEndpoint",
    "CEF"
  ],
  "query": "// Hunt: SolarWinds WHD Deserialization RCE (CVE-2025-40551)\n// Lookback: 30 days across all relevant telemetry\nlet lookback = 30d;\n// --- Section 1: Large POST requests to WHD endpoints ---\n// Java serialized payloads are typically 10-100KB+ and may use specific content types.\n// 500 errors may indicate failed deserialization probe attempts.\nlet WHD_SuspiciousPosts = union isfuzzy=true (\n    CommonSecurityLog\n    | where TimeGenerated >= ago(lookback)\n    | where RequestMethod == \"POST\"\n    | where RequestURL has_any (\n        \"/helpdesk/WebObjects/Helpdesk.woa\",\n        \"/helpdesk/api\",\n        \"/api/v1/\",\n        \"/WebHelpDesk/\"\n      )\n    | where AdditionalExtensions has_any (\n          \"application/x-java-serialized-object\",\n          \"application/octet-stream\"\n      )\n      or toint(RequestSize) > 65536\n      or tostring(EventOutcome) == \"500\"\n    | extend ResponseCode = tostring(EventOutcome)\n    | project TimeGenerated, SourceIP, DestinationIP, RequestURL,\n              RequestMethod, ResponseCode, RequestSize\n    | extend HuntSection = \"1-LargePOST\"\n);\n// --- Section 2: WHD Java process spawning shells (RCE success indicator) ---\nlet WHD_ShellSpawn = DeviceProcessEvents\n    | where TimeGenerated >= ago(lookback)\n    | where InitiatingProcessFileName in~ (\"java.exe\", \"javaw.exe\", \"tomcat.exe\", \"tomcat9.exe\")\n    | where InitiatingProcessCommandLine has_any (\n        \"helpdesk\", \"whd\", \"solarwinds\", \"WebHelpDesk\", \"Helpdesk.woa\"\n      )\n    | where FileName has_any (\n        \"cmd.exe\", \"powershell.exe\", \"pwsh.exe\",\n        \"sh\", \"bash\", \"dash\",\n        \"wget.exe\", \"curl.exe\", \"certutil.exe\",\n        \"bitsadmin.exe\", \"mshta.exe\", \"wscript.exe\"\n      )\n    | project TimeGenerated, DeviceName, AccountName, InitiatingProcessFileName,\n              InitiatingProcessCommandLine, FileName, ProcessCommandLine\n    | extend HuntSection = \"2-ShellSpawn\";\n// --- Section 3: Outbound C2 callbacks from WHD Java process ---\nlet WHD_OutboundC2 = DeviceNetworkEvents\n    | where TimeGenerated >= ago(lookback)\n    | where InitiatingProcessFileName in~ (\"java.exe\", \"javaw.exe\", \"tomcat.exe\", \"tomcat9.exe\")\n    | where InitiatingProcessCommandLine has_any (\n        \"helpdesk\", \"whd\", \"solarwinds\", \"WebHelpDesk\"\n      )\n    | where RemoteIPType !in (\"Private\", \"Loopback\")\n    | where not(RemoteUrl has_any (\n        \"solarwinds.com\", \"swid.solarwinds.com\",\n        \"windowsupdate.com\", \"microsoft.com\"\n      ))\n    | extend AccountName = InitiatingProcessAccountName\n    | project TimeGenerated, DeviceName, AccountName, InitiatingProcessFileName,\n              RemoteIP, RemotePort, RemoteUrl\n    | extend HuntSection = \"3-C2Callback\";\n// --- Section 4: Scheduled tasks or services created post-compromise ---\n// Attacker may persist via scheduled task or new service on WHD server\nlet WHD_Persistence = DeviceProcessEvents\n    | where TimeGenerated >= ago(lookback)\n    | where FileName in~ (\"schtasks.exe\", \"sc.exe\", \"reg.exe\", \"at.exe\")\n    | where InitiatingProcessFileName in~ (\"cmd.exe\", \"powershell.exe\", \"pwsh.exe\", \"java.exe\")\n    | where ProcessCommandLine has_any (\n        \"create\", \"/create\", \"start\", \"config\"\n      )\n    // Narrow to WHD-hosting machines by checking adjacent signals (imperfect heuristic)\n    | where DeviceName has_any (\"whd\", \"helpdesk\", \"solarwinds\", \"servicedesk\")\n    | project TimeGenerated, DeviceName, AccountName, InitiatingProcessFileName,\n              FileName, ProcessCommandLine\n    | extend HuntSection = \"4-Persistence\";\n// Union all sections and summarise\nunion WHD_SuspiciousPosts, WHD_ShellSpawn, WHD_OutboundC2, WHD_Persistence\n| extend HuntSection = coalesce(HuntSection, \"unknown\")\n| sort by TimeGenerated desc\n| project TimeGenerated, HuntSection, DeviceName, AccountName,\n          SourceIP, RemoteIP, RemotePort, RequestURL,\n          FileName, ProcessCommandLine, InitiatingProcessFileName",
  "source": "https://nvd.nist.gov/vuln/detail/CVE-2025-40551",
  "references": [
    "https://www.solarwinds.com/trust-center/security-advisories/cve-2025-40551",
    "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
    "https://nvd.nist.gov/vuln/detail/CVE-2025-40551"
  ],
  "created": "2026-02-23",
  "version": "1.0.0"
}
