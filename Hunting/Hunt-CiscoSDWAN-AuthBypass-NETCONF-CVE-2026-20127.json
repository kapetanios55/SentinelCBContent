{
  "id": "ecaf3bb0-169d-490f-a93f-9e4beac4edf8",
  "name": "Hunt - Cisco Catalyst SD-WAN Auth Bypass & NETCONF Abuse (CVE-2026-20127)",
  "description": "Hunting query to identify potential exploitation of CVE-2026-20127 in Cisco Catalyst SD-WAN Controller (vSmart) and Manager (vManage). The vulnerability allows unauthenticated remote attackers to bypass peering authentication and gain administrative access via NETCONF. Threat actors can use NETCONF (TCP 830) to reconfigure the entire SD-WAN fabric, redirect traffic, or establish persistence.\n\nCISA Emergency Directive 26-03 — due date 2026-02-27.\n\nHunting focuses on:\n1. NETCONF (TCP 830) connections from external or unexpected source IPs\n2. Successful auth events to vManage/vSmart with no prior failed attempts (bypass pattern)\n3. Configuration change events that lack a legitimate change window or known admin source\n4. Unusual admin account activity on Cisco SD-WAN infrastructure\n\nReference: https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-sdwan-rpa-EHchtZk",
  "tags": [
    { "name": "tactics", "value": "InitialAccess,PrivilegeEscalation,Persistence" },
    { "name": "techniques", "value": "T1078,T1556,T1098" },
    { "name": "cve", "value": "CVE-2026-20127" },
    { "name": "severity", "value": "High" },
    { "name": "source", "value": "CISA-KEV-2026-02-25,ED-26-03" }
  ],
  "category": "Hunting Queries",
  "version": 2,
  "query": "// HUNT 1: NETCONF (TCP 830) connections to Cisco SD-WAN infrastructure\nlet netconf_hunt = \n    union isfuzzy=true\n    (\n        DeviceNetworkEvents\n        | where RemotePort == 830 or LocalPort == 830\n        | where DeviceName has_any (\"vmanage\", \"vsmart\", \"sdwan\", \"cisco\")\n            or RemoteIP !startswith \"10.\" and RemoteIP !startswith \"192.168.\" and RemoteIP !startswith \"172.\"\n        | extend AccountName = InitiatingProcessAccountName\n        | extend HuntType = \"NETCONF-Connection-TCP830\"\n        | project TimeGenerated, DeviceName, RemoteIP, RemotePort, LocalIP, LocalPort,\n                  InitiatingProcessFileName, AccountName, HuntType\n    ),\n    (\n        CommonSecurityLog\n        | where DeviceVendor has_any (\"Cisco\")\n        | where DeviceProduct has_any (\"SD-WAN\", \"vManage\", \"vSmart\", \"Catalyst SD-WAN\")\n        | where DestinationPort == 830 or SourcePort == 830\n            or Message has_any (\"netconf\", \"NETCONF\", \"tcp/830\")\n        | extend AccountName = SourceUserName\n        | extend HuntType = \"NETCONF-CSL\"\n        | project TimeGenerated, DeviceVendor, DeviceProduct, SourceIP, DestinationIP,\n                  DestinationPort, Message, AccountName, HuntType\n    )\n;\n// HUNT 2: Successful admin auth to vManage/vSmart with no prior failures (bypass pattern)\nlet auth_bypass_hunt =\n    CommonSecurityLog\n    | where DeviceVendor has_any (\"Cisco\")\n    | where DeviceProduct has_any (\"SD-WAN\", \"vManage\", \"vSmart\", \"Catalyst SD-WAN\")\n    | where Activity has_any (\"login\", \"authentication\", \"session\", \"admin\")\n    | where EventOutcome !in~ (\"failed\", \"failure\", \"denied\", \"blocked\", \"reject\")\n    | extend AccountName = SourceUserName\n    | join kind=leftanti (\n        CommonSecurityLog\n        | where DeviceVendor has_any (\"Cisco\")\n        | where DeviceProduct has_any (\"SD-WAN\", \"vManage\", \"vSmart\")\n        | where EventOutcome in~ (\"failed\", \"failure\", \"denied\")\n        | summarize FailCount = count() by SourceIP\n        | where FailCount > 0\n    ) on SourceIP\n    | extend HuntType = \"SuccessAuth-NoFailures-PossibleBypass\"\n    | project TimeGenerated, DeviceVendor, DeviceProduct, SourceIP, DestinationIP,\n              AccountName, Activity, Message, HuntType\n;\n// HUNT 3: Config change events to SD-WAN fabric\nlet config_change_hunt =\n    union isfuzzy=true\n    (\n        CommonSecurityLog\n        | where DeviceVendor has_any (\"Cisco\")\n        | where DeviceProduct has_any (\"SD-WAN\", \"vManage\", \"Catalyst SD-WAN\")\n        | where Activity has_any (\"config\", \"configuration\", \"policy\", \"template\", \"push\", \"deploy\")\n            or Message has_any (\"configuration change\", \"policy update\", \"template push\",\n                                 \"netconf edit\", \"config commit\", \"device attach\")\n        | extend AccountName = SourceUserName\n        | extend HuntType = \"ConfigChange-FabricModification\"\n        | project TimeGenerated, DeviceVendor, DeviceProduct, SourceIP, Message,\n                  AccountName, Activity, HuntType\n    )\n;\nunion netconf_hunt, auth_bypass_hunt, config_change_hunt\n| sort by TimeGenerated desc\n| extend CVE = \"CVE-2026-20127\"\n| extend Reference = \"https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-sdwan-rpa-EHchtZk\"\n| extend CISA_ED = \"ED-26-03 – Due 2026-02-27\""
}
