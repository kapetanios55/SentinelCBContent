{
  "id": "hunt-fortinet-forticloud-sso-24858",
  "name": "Hunt: Fortinet FortiCloud SSO Abuse â€” CVE-2026-24858",
  "description": "Hunts for evidence of FortiCloud SSO authentication bypass activity across Fortinet appliances. CVE-2026-24858 allows an attacker with any FortiCloud account + registered device to authenticate to other organisations' appliances where FortiCloud SSO is enabled. This query surfaces all FortiCloud SSO login events grouped by account, device, and source geography to aid analyst review. Look for accounts authenticating to more devices than expected, or authentications from unexpected countries.",
  "category": "Hunting Queries",
  "version": 2,
  "tactics": ["InitialAccess", "DefenseEvasion"],
  "techniques": ["T1078", "T1199"],
  "query": "let lookback = 30d;\nlet FortiCloudSSOEvents = union isfuzzy=true\n(\n    CommonSecurityLog\n    | where TimeGenerated >= ago(lookback)\n    | where DeviceVendor =~ \"Fortinet\"\n    | where DeviceProduct in~ (\"FortiGate\", \"FortiAnalyzer\", \"FortiManager\", \"FortiProxy\", \"FortiOS\")\n    | where Message has_any (\"forticloud\", \"cloud-sso\", \"FortiCloud_SSO\", \"sso_login\")\n        or (Activity has_any (\"login\", \"logon\", \"auth\") and AdditionalExtensions has \"forticloud\")\n    | extend AccountName = SourceUserName\n    | extend SrcIP = SourceIP\n    | project TimeGenerated, AccountName, SrcIP, DeviceName, DeviceProduct, Activity, Message, AdditionalExtensions\n);\n// Summarise by account to spot accounts hitting many devices (lateral movement indicator)\nlet AccountSummary = FortiCloudSSOEvents\n| summarize\n    DevicesAccessed = dcount(DeviceName),\n    DeviceList = make_set(DeviceName),\n    SourceIPs = make_set(SrcIP),\n    FirstSeen = min(TimeGenerated),\n    LastSeen = max(TimeGenerated),\n    EventCount = count()\n    by AccountName;\n// Flag accounts touching more than 1 device or using multiple source IPs\nAccountSummary\n| where DevicesAccessed > 1 or array_length(SourceIPs) > 1\n| extend RiskIndicator = case(\n    DevicesAccessed > 3, \"HIGH: Account accessed 4+ Fortinet devices\",\n    array_length(SourceIPs) > 2, \"MEDIUM: Authentication from 3+ distinct source IPs\",\n    DevicesAccessed > 1, \"MEDIUM: Account accessed multiple Fortinet devices\",\n    \"LOW\"\n)\n| order by DevicesAccessed desc",
  "references": [
    "https://fortiguard.fortinet.com/psirt/FG-IR-26-060",
    "https://www.fortinet.com/blog/psirt-blogs/analysis-of-sso-abuse-on-fortios",
    "https://nvd.nist.gov/vuln/detail/CVE-2026-24858"
  ]
}
