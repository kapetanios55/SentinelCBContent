id: b7c3d1e2-f4a5-6789-bcde-f01234567891
name: Dell RecoverPoint RP4VMs Exploitation & UNC6201 TTP Detection (CVE-2026-22769)
description: |
  Detects exploitation of CVE-2026-22769, a hard-coded credentials vulnerability in Dell
  RecoverPoint for Virtual Machines (RP4VMs). This flaw allows unauthenticated remote
  attackers to authenticate to the Tomcat Manager using default credentials and deploy a
  malicious WAR file to gain root-level access.

  This vulnerability has been actively exploited by UNC6201, a suspected PRC-nexus threat
  cluster (overlapping with UNC5221 / Silk Typhoon), since at least mid-2024. Post-exploitation
  activity includes deployment of SLAYSTYLE web shells, BRICKSTORM and GRIMBOLT backdoors,
  creation of Ghost NICs on VMware ESXi for stealthy lateral movement, and Single Packet
  Authorization (SPA) via iptables for C2 channel protection.

  CVE-2026-22769 was added to the CISA KEV catalog on 2026-02-18 with a due date of 2026-02-21.
  CVSS score: 10.0 (Critical).

  References:
    - https://www.dell.com/support/kbdoc/en-us/000426773/dsa-2026-079
    - https://cloud.google.com/blog/topics/threat-intelligence/unc6201-exploiting-dell-recoverpoint-zero-day
    - https://nvd.nist.gov/vuln/detail/CVE-2026-22769
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog

severity: High
status: Available
requiredDataConnectors:
  - connectorId: Syslog
    datatypes:
      - Syslog
  - connectorId: CEF
    datatypes:
      - CommonSecurityLog
  - connectorId: AzureMonitor(VMInsights)
    datatypes:
      - InsightsMetrics
  - connectorId: MicrosoftDefenderForEndpoint
    datatypes:
      - DeviceEvents
      - DeviceProcessEvents
      - DeviceNetworkEvents
      - DeviceFileEvents
queryFrequency: 1h
queryPeriod: 1h
triggerOperator: gt
triggerThreshold: 0
tactics:
  - InitialAccess
  - Execution
  - Persistence
  - LateralMovement
  - CommandAndControl
relevantTechniques:
  - T1190
  - T1059
  - T1505.003
  - T1021.001
  - T1572
query: |
  // -----------------------------------------------------------------------
  // Query 1: Tomcat Manager WAR file deployment (web shell delivery)
  // Detects POST requests to /manager/text/deploy or /manager/html/deploy
  // which UNC6201 used to deploy SLAYSTYLE web shell via CVE-2026-22769
  // -----------------------------------------------------------------------
  let TomcatWARDeploy = CommonSecurityLog
    | where TimeGenerated > ago(1h)
    | where RequestURL has_any ("/manager/text/deploy", "/manager/html/deploy")
        and RequestMethod == "PUT"
    | extend AlertDetail = "Tomcat Manager WAR deployment detected - possible CVE-2026-22769 exploitation"
    | project TimeGenerated, DeviceVendor, DeviceProduct, SourceIP, DestinationIP,
              RequestURL, RequestMethod, AlertDetail;
  // -----------------------------------------------------------------------
  // Query 2: GRIMBOLT / BRICKSTORM known file indicators
  // Detect presence or creation of known malware persistence paths
  // -----------------------------------------------------------------------
  let GrimboltBrickstormFiles = DeviceFileEvents
    | where TimeGenerated > ago(1h)
    | where FolderPath has_any ("/home/kos/", "/etc/rc.local", "convert_hosts.sh")
        or FileName has_any ("grimbolt", "brickstorm", "slaystyle")
    | extend AlertDetail = "GRIMBOLT/BRICKSTORM/SLAYSTYLE file indicator detected on host"
    | project TimeGenerated, DeviceName, InitiatingProcessFileName,
              FolderPath, FileName, SHA256, AlertDetail;
  // -----------------------------------------------------------------------
  // Query 3: SPA iptables commands (UNC6201 C2 protection technique)
  // Detects iptables rules used for Single Packet Authorization pivoting
  // -----------------------------------------------------------------------
  let SPAIptables = DeviceProcessEvents
    | where TimeGenerated > ago(1h)
    | where FileName == "iptables"
        and (ProcessCommandLine has "--dport 443" or ProcessCommandLine has "--dport 10443")
        and (ProcessCommandLine has "REDIRECT" or ProcessCommandLine has "PREROUTING"
             or ProcessCommandLine has "port_filter" or ProcessCommandLine has "ipt")
    | extend AlertDetail = "UNC6201-style Single Packet Authorization iptables rule detected"
    | project TimeGenerated, DeviceName, AccountName, ProcessCommandLine, AlertDetail;
  // -----------------------------------------------------------------------
  // Query 4: Ghost NIC creation on ESXi / VMware (UNC6201 lateral movement)
  // Detects dynamic addition of network adapters to running VMs
  // -----------------------------------------------------------------------
  let GhostNIC = Syslog
    | where TimeGenerated > ago(1h)
    | where SyslogMessage has_any ("Hot add of device", "vmxnet3", "Hot-plug", "add network adapter")
        and SyslogMessage has_any ("esxi", "vmkernel", "hostd", "vmx")
    | extend AlertDetail = "Possible Ghost NIC creation on ESXi (UNC6201 lateral movement technique)"
    | project TimeGenerated, Computer, HostName, SyslogMessage, AlertDetail;
  // Union all sub-queries
  union TomcatWARDeploy, GrimboltBrickstormFiles, SPAIptables, GhostNIC
  | sort by TimeGenerated desc

entityMappings:
  - entityType: Host
    fieldMappings:
      - identifier: FullName
        columnName: DeviceName
  - entityType: IP
    fieldMappings:
      - identifier: Address
        columnName: SourceIP
  - entityType: File
    fieldMappings:
      - identifier: Name
        columnName: FileName

customDetails:
  AlertDetail: AlertDetail

alertDetailsOverride:
  alertDisplayNameFormat: "UNC6201/CVE-2026-22769 TTP Detected: {{AlertDetail}}"
  alertDescriptionFormat: "Dell RecoverPoint exploitation or UNC6201 post-exploitation activity detected. Detail: {{AlertDetail}}"
  alertSeverityColumnName: null
  alertTacticsColumnName: null

suppressionDuration: 5h
suppressionEnabled: false
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: true
    reopenClosedIncident: false
    lookbackDuration: 5h
    matchingMethod: AllEntities
    groupByEntities:
      - Host
      - IP
    groupByAlertDetails: []
    groupByCustomDetails: []

version: 1.0.1
kind: Scheduled
