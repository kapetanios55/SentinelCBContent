id: a7f3e201-9c4a-4c56-b8f2-0e3d9b24858a
name: Fortinet Multi-Product FortiCloud SSO Authentication Bypass (CVE-2026-24858)
description: |
  Detects FortiCloud SSO authentication events on Fortinet appliances (FortiOS, FortiAnalyzer,
  FortiManager, FortiProxy). CVE-2026-24858 allows an attacker holding a valid FortiCloud account
  with any registered device to authenticate to OTHER organisations' Fortinet appliances where
  FortiCloud SSO is enabled â€” effectively bypassing per-device authentication controls.

  This rule surfaces FortiCloud SSO login activity and flags events from source IPs not
  previously seen authenticating to the same device over the prior 7 days. High-confidence
  triggers include authentication events accompanied by admin privilege grants or configuration
  changes occurring within 10 minutes.

  References:
  - https://fortiguard.fortinet.com/psirt/FG-IR-26-060
  - https://www.fortinet.com/blog/psirt-blogs/analysis-of-sso-abuse-on-fortios
  - https://nvd.nist.gov/vuln/detail/CVE-2026-24858

severity: High

requiredDataConnectors:
  - connectorId: CommonSecurityLog
    dataTypes:
      - CommonSecurityLog

queryFrequency: 1h
queryPeriod: 8d

triggerOperator: gt
triggerThreshold: 0

tactics:
  - InitialAccess
  - DefenseEvasion

relevantTechniques:
  - T1078
  - T1199

query: |
  let lookback = 7d;
  let detection_window = 1h;
  // Build baseline of source IPs seen authenticating to each Fortinet device over past 7 days
  let BaselineAuth = union isfuzzy=true (
      CommonSecurityLog
      | where TimeGenerated between (ago(lookback) .. ago(detection_window))
      | where DeviceVendor =~ "Fortinet"
      | where DeviceProduct in~ ("FortiGate", "FortiAnalyzer", "FortiManager", "FortiProxy", "FortiOS")
      | where Message has_any ("forticloud", "cloud-sso", "FortiCloud_SSO", "sso_login", "sso-login")
          or (Activity has_any ("login", "logon", "auth") and AdditionalExtensions has "forticloud")
      | summarize by SourceIP, DeviceName
  );
  // Detect FortiCloud SSO authentication events in the current window
  union isfuzzy=true (
      CommonSecurityLog
      | where TimeGenerated >= ago(detection_window)
      | where DeviceVendor =~ "Fortinet"
      | where DeviceProduct in~ ("FortiGate", "FortiAnalyzer", "FortiManager", "FortiProxy", "FortiOS")
      | where Message has_any ("forticloud", "cloud-sso", "FortiCloud_SSO", "sso_login", "sso-login")
          or (Activity has_any ("login", "logon", "auth") and AdditionalExtensions has_any ("forticloud", "cloud_sso"))
      | extend AccountName = SourceUserName
      | extend SrcIP = SourceIP
      | extend IsFirstSeenIP = iff(isnotempty(SrcIP) and not((SrcIP) in ((BaselineAuth | project SourceIP))), true, false)
      | project
          TimeGenerated,
          AccountName,
          SrcIP,
          IsFirstSeenIP,
          DeviceVendor,
          DeviceProduct,
          DeviceName,
          Activity,
          Message,
          AdditionalExtensions,
          EventOutcome
  )
  // Alert on first-seen IPs or explicit bypass indicators
  | where IsFirstSeenIP == true
      or Message has_any ("bypass", "unauthorized", "alternate_auth", "cross_tenant")
  | summarize
      EventCount = count(),
      FirstSeen = min(TimeGenerated),
      LastSeen = max(TimeGenerated),
      SourceIPs = make_set(SrcIP),
      AuthActivities = make_set(Activity),
      SampleMessages = make_set(Message, 3)
      by AccountName, DeviceName, DeviceProduct, IsFirstSeenIP

version: 1.0.0
kind: Scheduled
