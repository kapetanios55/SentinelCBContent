id: f3c4d5e6-f7a8-9012-cdef-012345678905
name: SolarWinds Web Help Desk Authentication Bypass (CVE-2025-40536)
description: |
  Detects exploitation of CVE-2025-40536, a security control bypass vulnerability in
  SolarWinds Web Help Desk (WHD). This vulnerability allows an unauthenticated remote
  attacker to access restricted administrative functionality without valid credentials,
  potentially leading to data theft, configuration tampering, or further compromise
  of the IT service management infrastructure.

  SolarWinds WHD is a high-value target for attackers due to its privileged access to
  asset inventories, credentials, and IT workflows. Historical SolarWinds compromises
  (e.g., SUNBURST) demonstrate the risk of supply chain and product vulnerabilities.

  Detection focuses on:
  - Access to admin/API endpoints without prior authentication events
  - Unusual source IPs accessing WHD admin functionality
  - Bulk data access or export operations via the API
  - Configuration changes made through the WHD interface

  CVE-2025-40536 was added to the CISA KEV catalog on 2026-02-12 (due 2026-02-15 — past due).

  References:
    - https://www.solarwinds.com/trust-center/security-advisories/CVE-2025-40536
    - https://nvd.nist.gov/vuln/detail/CVE-2025-40536
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog

severity: High
status: Available
requiredDataConnectors:
  - connectorId: CEF
    datatypes:
      - CommonSecurityLog
  - connectorId: MicrosoftDefenderForEndpoint
    datatypes:
      - DeviceProcessEvents
      - DeviceNetworkEvents
queryFrequency: 1h
queryPeriod: 1h
triggerOperator: gt
triggerThreshold: 0
tactics:
  - InitialAccess
  - PrivilegeEscalation
  - Collection
relevantTechniques:
  - T1190
  - T1078
  - T1530
query: |
  // -----------------------------------------------------------------------
  // Query 1: Access to WHD admin/API endpoints from new or unusual IPs
  // The bypass allows unauthenticated access to restricted paths.
  // Flag access to sensitive WHD paths from IPs with no prior auth events.
  // -----------------------------------------------------------------------
  let WHD_AdminAccess = union isfuzzy=true (
    CommonSecurityLog
    | where TimeGenerated > ago(1h)
    | where RequestURL has_any (
        "/helpdesk/WebObjects/Helpdesk.woa/ra/",  // REST API base
        "/helpdesk/WebObjects/Helpdesk.woa/wa/",  // Admin actions
        "/helpdesk/WebObjects/Helpdesk.woa/wo/",  // Web objects
        "/api/v1/admin", "/api/v1/assets", "/api/v1/tickets",
        "/api/v1/clients", "/api/v1/accounts"
      )
    | where RequestMethod in ("GET", "POST", "PUT", "DELETE", "PATCH")
    // Flag requests that bypass normal login flow (no session cookie indicators)
    | where AdditionalExtensions !has "sessionToken" and AdditionalExtensions !has "JSESSIONID"
        or RequestURL has_any ("export", "backup", "config", "admin/user", "admin/setting")
    | extend AlertDetail = strcat("WHD restricted endpoint accessed from ",
        SourceIP, ": ", RequestMethod, " ", RequestURL)
    | project TimeGenerated, SourceIP, DestinationIP, RequestURL, RequestMethod,
              ResponseCode, AlertDetail
  );
  // -----------------------------------------------------------------------
  // Query 2: Bulk data export or enumeration via WHD API
  // Post-auth-bypass attacker likely enumerates assets, tickets, user accounts
  // -----------------------------------------------------------------------
  let WHD_BulkExport = union isfuzzy=true (
    CommonSecurityLog
    | where TimeGenerated > ago(1h)
    | where RequestURL has_any (
        "export", "download", "report", "csv", "xls",
        "/api/v1/assets?", "/api/v1/clients?", "/api/v1/tickets?"
      )
    | where DeviceProduct has_any ("SolarWinds", "WebHelpDesk", "WHD")
        or DestinationPort in (8081, 443, 80)
    | summarize RequestCount = count(), UniqueURLs = dcount(RequestURL)
        by SourceIP, bin(TimeGenerated, 5m)
    | where RequestCount >= 10
    | extend AlertDetail = strcat("Possible WHD bulk data enumeration from ",
        SourceIP, ": ", RequestCount, " requests in 5 minutes")
    | project TimeGenerated, SourceIP, RequestCount, UniqueURLs, AlertDetail
  );
  // -----------------------------------------------------------------------
  // Query 3: WHD server-side process anomalies (post-exploitation)
  // If attacker achieves RCE via WHD, look for unusual processes
  // -----------------------------------------------------------------------
  let WHD_ProcessAnomaly = DeviceProcessEvents
    | where TimeGenerated > ago(1h)
    | where InitiatingProcessFileName has_any (
        "java.exe", "javaw.exe"  // WHD runs on Java/Tomcat
      )
    | where InitiatingProcessCommandLine has_any ("helpdesk", "whd", "solarwinds", "WebHelpDesk")
    | where FileName has_any (
        "cmd.exe", "powershell.exe", "pwsh.exe", "sh", "bash",
        "curl.exe", "wget.exe", "certutil.exe", "net.exe"
      )
    | extend AlertDetail = strcat("SolarWinds WHD Java process spawned: ", FileName,
        " — possible post-exploitation")
    | project TimeGenerated, DeviceName, AccountName, InitiatingProcessFileName,
              FileName, ProcessCommandLine, AlertDetail;
  // Union all sub-queries
  union WHD_AdminAccess, WHD_BulkExport, WHD_ProcessAnomaly
  | sort by TimeGenerated desc

entityMappings:
  - entityType: Host
    fieldMappings:
      - identifier: FullName
        columnName: DeviceName
  - entityType: IP
    fieldMappings:
      - identifier: Address
        columnName: SourceIP
  - entityType: Account
    fieldMappings:
      - identifier: Name
        columnName: AccountName

customDetails:
  AlertDetail: AlertDetail

alertDetailsOverride:
  alertDisplayNameFormat: "SolarWinds WHD CVE-2025-40536 Indicator: {{AlertDetail}}"
  alertDescriptionFormat: "Possible exploitation of SolarWinds Web Help Desk auth bypass (CVE-2025-40536). {{AlertDetail}}"

suppressionDuration: 4h
suppressionEnabled: false
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: true
    reopenClosedIncident: false
    lookbackDuration: 4h
    matchingMethod: AllEntities
    groupByEntities:
      - Host
      - IP
    groupByAlertDetails: []
    groupByCustomDetails: []

version: 1.0.0
kind: Scheduled
