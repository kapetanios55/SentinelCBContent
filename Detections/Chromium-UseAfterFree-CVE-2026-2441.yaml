id: f2b3c4d5-e6f7-8901-bcde-f01234567904
name: Google Chromium CSS Use-After-Free Exploitation (CVE-2026-2441)
description: |
  Detects potential exploitation of CVE-2026-2441, a use-after-free vulnerability in the
  CSS implementation of Google Chromium. A remote attacker can exploit this vulnerability
  via a crafted HTML page to corrupt heap memory and achieve remote code execution in
  the context of the browser renderer process.

  This vulnerability affects all Chromium-based browsers including Google Chrome,
  Microsoft Edge, and Opera. Successful exploitation typically requires a renderer
  sandbox escape to execute code outside the browser sandbox.

  Detection focuses on:
  - Chrome/Edge renderer processes spawning unexpected child processes (sandbox escape indicator)
  - Browser processes making unusual outbound network connections post-exploitation
  - Suspicious child process chains originating from browser helper processes

  CVE-2026-2441 was added to the CISA KEV catalog on 2026-02-17 with CVSS score: 8.8.
  Patch: Chrome 132.0.6834.110+ / Edge equivalent.

  References:
    - https://chromereleases.googleblog.com/2026/02/stable-channel-update-for-desktop_13.html
    - https://nvd.nist.gov/vuln/detail/CVE-2026-2441
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog

severity: High
status: Available
requiredDataConnectors:
  - connectorId: MicrosoftDefenderForEndpoint
    datatypes:
      - DeviceProcessEvents
      - DeviceNetworkEvents
      - DeviceFileEvents
queryFrequency: 1h
queryPeriod: 1h
triggerOperator: gt
triggerThreshold: 0
tactics:
  - InitialAccess
  - Execution
  - DefenseEvasion
relevantTechniques:
  - T1189
  - T1203
  - T1055
query: |
  // -----------------------------------------------------------------------
  // Query 1: Browser renderer spawning unexpected processes (sandbox escape)
  // A successful use-after-free exploit in Chromium requires escaping the
  // renderer sandbox to execute arbitrary code. This manifests as the
  // renderer process (chrome.exe --type=renderer) spawning child processes.
  // -----------------------------------------------------------------------
  let BrowserSandboxEscape = DeviceProcessEvents
    | where TimeGenerated > ago(1h)
    | where InitiatingProcessFileName has_any (
        "chrome.exe", "msedge.exe", "opera.exe", "brave.exe", "chromium.exe"
      )
    | where InitiatingProcessCommandLine has_any (
        "--type=renderer", "--type=gpu-process", "--type=utility"
      )
    | where FileName has_any (
        "cmd.exe", "powershell.exe", "pwsh.exe", "wscript.exe", "cscript.exe",
        "mshta.exe", "rundll32.exe", "regsvr32.exe", "certutil.exe",
        "bitsadmin.exe", "curl.exe", "msiexec.exe", "wmic.exe",
        "schtasks.exe", "at.exe", "sc.exe", "net.exe", "net1.exe"
      )
    | extend AlertDetail = strcat("Browser renderer '", InitiatingProcessFileName,
        "' spawned process '", FileName, "' — possible CVE-2026-2441 sandbox escape")
    | project TimeGenerated, DeviceName, AccountName, InitiatingProcessFileName,
              InitiatingProcessCommandLine, FileName, ProcessCommandLine, AlertDetail;
  // -----------------------------------------------------------------------
  // Query 2: Browser process injecting into other processes (post-exploitation)
  // After sandbox escape, attacker may inject into a trusted process
  // -----------------------------------------------------------------------
  let BrowserProcessInjection = DeviceEvents
    | where TimeGenerated > ago(1h)
    | where ActionType has_any ("CreateRemoteThreadApiCall", "WriteProcessMemoryApiCall",
                                "QueueUserApcRemoteApiCall", "SetThreadContextRemoteApiCall")
    | where InitiatingProcessFileName has_any (
        "chrome.exe", "msedge.exe", "opera.exe", "brave.exe", "chromium.exe"
      )
    | where InitiatingProcessCommandLine has_any (
        "--type=renderer", "--type=gpu-process", "--type=utility", "--no-sandbox"
      )
    | extend AlertDetail = strcat("Browser renderer performed process injection (",
        ActionType, ") — possible post-exploitation via CVE-2026-2441")
    | project TimeGenerated, DeviceName, AccountName, InitiatingProcessFileName,
              InitiatingProcessCommandLine, ActionType, AlertDetail;
  // -----------------------------------------------------------------------
  // Query 3: Browser dropping executable files to disk (dropper activity)
  // -----------------------------------------------------------------------
  let BrowserDropper = DeviceFileEvents
    | where TimeGenerated > ago(1h)
    | where InitiatingProcessFileName has_any (
        "chrome.exe", "msedge.exe", "opera.exe", "brave.exe", "chromium.exe"
      )
    | where InitiatingProcessCommandLine has_any (
        "--type=renderer", "--type=gpu-process", "--no-sandbox"
      )
    | where FileName has_any (".exe", ".dll", ".ps1", ".bat", ".vbs", ".js", ".hta", ".msi")
        or FolderPath has_any ("\\Temp\\", "\\AppData\\Local\\Temp\\", "\\Public\\")
    | where ActionType in ("FileCreated", "FileModified")
    | extend AlertDetail = strcat("Browser renderer wrote suspicious file: ",
        FolderPath, "\\", FileName)
    | project TimeGenerated, DeviceName, InitiatingProcessFileName,
              FolderPath, FileName, SHA256, AlertDetail;
  // Union all sub-queries
  union BrowserSandboxEscape, BrowserProcessInjection, BrowserDropper
  | sort by TimeGenerated desc

entityMappings:
  - entityType: Host
    fieldMappings:
      - identifier: FullName
        columnName: DeviceName
  - entityType: Account
    fieldMappings:
      - identifier: Name
        columnName: AccountName
  - entityType: File
    fieldMappings:
      - identifier: Name
        columnName: FileName

customDetails:
  AlertDetail: AlertDetail

alertDetailsOverride:
  alertDisplayNameFormat: "Chromium CVE-2026-2441 Exploit Indicator: {{AlertDetail}}"
  alertDescriptionFormat: "Possible exploitation of Chromium CSS use-after-free (CVE-2026-2441). {{AlertDetail}}"

suppressionDuration: 2h
suppressionEnabled: false
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: true
    reopenClosedIncident: false
    lookbackDuration: 2h
    matchingMethod: AllEntities
    groupByEntities:
      - Host
      - Account
    groupByAlertDetails: []
    groupByCustomDetails: []

version: 1.0.0
kind: Scheduled
