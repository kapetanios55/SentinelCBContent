id: a1f2b3c4-d5e6-7890-abcd-ef1234567890
name: RoundCube Webmail Exploitation Attempt (CVE-2025-68461 / CVE-2025-49113)
description: |
  Detects exploitation attempts targeting RoundCube Webmail.
  CVE-2025-68461 is a stored XSS via SVG animate tags.
  CVE-2025-49113 is a deserialization RCE via the _from parameter in upload.php.
  Both were added to the CISA KEV catalog on 2026-02-20.
  RoundCube is widely used in government and enterprise environments and has been
  targeted by APT28 and other state actors.
  References:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-68461
  - https://nvd.nist.gov/vuln/detail/CVE-2025-49113
  - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
severity: High
status: Available
requiredDataConnectors:
  - connectorId: CEF
    datatypes:
      - CommonSecurityLog
  - connectorId: AzureFirewall
    datatypes:
      - AzureDiagnostics
queryFrequency: 1h
queryPeriod: 1h
triggerOperator: gt
triggerThreshold: 0
tactics:
  - InitialAccess
  - Execution
relevantTechniques:
  - T1190
  - T1059
query: |
  let timeframe = 1h;
  let roundcube_rce_patterns = dynamic(['/upload.php', '_from=', 'settings/upload']);
  let roundcube_xss_patterns = dynamic(['<animate', 'onbegin=', 'onend=']);
  // CommonSecurityLog (Proxy/Firewall/WAF)
  CommonSecurityLog
  | where TimeGenerated >= ago(timeframe)
  | where RequestURL has_any ('/roundcube', '/webmail', '/rcmail')
    or DestinationHostName has_any ('roundcube', 'webmail')
  | where RequestURL has_any (roundcube_rce_patterns)
     or RequestURL matches regex @'[?&]_from='
     or AdditionalExtensions has_any (roundcube_xss_patterns)
  | extend AttackType = case(
      RequestURL has '/upload.php' or RequestURL matches regex @'[?&]_from=', 'CVE-2025-49113 - Deserialization RCE',
      AdditionalExtensions has '<animate', 'CVE-2025-68461 - SVG XSS',
      'RoundCube Suspicious Request'
    )
  | project TimeGenerated, SourceIP, DestinationIP, DestinationHostName, RequestURL, AttackType, DeviceVendor, DeviceProduct
  | union (
      AzureDiagnostics
      | where TimeGenerated >= ago(timeframe)
      | where Category in ('AzureFirewallApplicationRule', 'AzureFirewallNetworkRule')
      | where requestUrl_s has_any ('/roundcube', '/webmail', '/rcmail')
        and (requestUrl_s has '/upload.php' or requestUrl_s matches regex @'[?&]_from=')
      | extend SourceIP = srcIp_s, DestinationIP = dstIp_s, RequestURL = requestUrl_s
      | extend AttackType = 'CVE-2025-49113 - Deserialization RCE'
      | project TimeGenerated, SourceIP, DestinationIP, DestinationHostName = '', RequestURL, AttackType, DeviceVendor = 'Azure', DeviceProduct = 'AzureFirewall'
  )
  | summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), RequestCount = count(), Requests = make_set(RequestURL, 10)
      by SourceIP, AttackType
  | extend AlertSeverity = 'High'
  | sort by RequestCount desc
entityMappings:
  - entityType: IP
    fieldMappings:
      - identifier: Address
        columnName: SourceIP
version: 1.0.2
kind: Scheduled
