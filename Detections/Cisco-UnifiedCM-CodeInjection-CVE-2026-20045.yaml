id: 230aee0a-bed0-458f-882f-7e87e7a8362d
name: Cisco Unified Communications Manager Code Injection RCE (CVE-2026-20045)
description: |
  Detects exploitation of CVE-2026-20045, a code injection vulnerability affecting multiple
  Cisco Unified Communications products:
  - Unified Communications Manager (Unified CM)
  - Unified CM Session Management Edition (Unified CM SME)
  - Unified CM IM & Presence Service (Unified CM IM&P)
  - Unity Connection
  - Webex Calling Dedicated Instance

  Successful exploitation allows an attacker to obtain user-level OS access and then escalate
  to root. The vulnerability exists in the web-based management interface.

  CISA KEV added: 2026-01-21. Due: 2026-02-11.

  Detection approach:
  - Syslog/CommonSecurityLog: Suspicious HTTP requests to Cisco CUCM management interfaces
    targeting injection points; unusual process execution in Cisco service logs
  - DeviceProcessEvents: Cisco services spawning unexpected OS commands
  - SecurityEvent: Privilege escalation following Cisco UCM service interaction

severity: High
status: Available
requiredDataConnectors:
  - connectorId: CommonSecurityLog
    dataTypes:
      - CommonSecurityLog
  - connectorId: Syslog
    dataTypes:
      - Syslog
  - connectorId: MicrosoftDefenderAdvancedThreatProtection
    dataTypes:
      - DeviceProcessEvents

queryFrequency: 1h
queryPeriod: 1h

triggerOperator: gt
triggerThreshold: 0

tactics:
  - InitialAccess
  - Execution
  - PrivilegeEscalation

relevantTechniques:
  - T1190
  - T1059
  - T1068

query: |
  // CVE-2026-20045: Cisco Unified CM Code Injection
  // Branch 1: CommonSecurityLog — suspicious requests to Cisco CUCM admin/web interface
  let CiscoUCMWebAttack = union isfuzzy=true (
    CommonSecurityLog
    | where TimeGenerated > ago(1h)
    | where DeviceProduct has_any ("Cisco", "CUCM", "UCM", "UnifiedCM", "Unity")
       or DestinationPort in (8443, 8080, 443, 80, 8123)
    | where (
        // Code injection patterns in URL or user agent
        RequestURL has_any (";", "|", "&&", "||", "`", "$(", "${")
        or RequestURL has_any ("cmd=", "exec=", "command=", "system=", "shell=")
        or RequestURL has_any ("/ccmuser/logon.asp", "/admin/", "/ucmuser/")
        // Shell metacharacters in request parameters
        or AdditionalExtensions has_any ("cmd=", "exec=", ";/bin/", ";bash", "|bash", "|sh")
      )
    | extend
        SourceAddress = SourceIP,
        ThreatIndicator = "Suspicious request to Cisco UCM web interface (possible code injection)",
        ResponseStatus = tostring(EventOutcome)
    | project TimeGenerated, DeviceName, SourceAddress, RequestURL, ResponseStatus, ThreatIndicator
  );
  // Branch 2: Syslog — Cisco CUCM services spawning unexpected OS-level commands
  let CiscoUCMSyslog = union isfuzzy=true (
    Syslog
    | where TimeGenerated > ago(1h)
    | where (ProcessName has_any ("ccm", "cucm", "Cisco_CM", "tomcat", "java")
             or Computer has_any ("cucm", "ucm", "callmanager", "unity", "ciscocm"))
       and (SyslogMessage has_any ("/bin/sh", "/bin/bash", "curl ", "wget ", "chmod +x", "/tmp/", "python -c", "perl -e")
            or SyslogMessage has_any ("privilege escalat", "root shell", "su -", "sudo su"))
    | extend ThreatIndicator = "Cisco UCM service log shows suspicious command execution", DeviceName = Computer
    | project TimeGenerated, DeviceName, ProcessName, SyslogMessage, ThreatIndicator
  );
  // Branch 3: DeviceProcessEvents — Cisco service processes spawning shells
  let CiscoUCMProcessExec = DeviceProcessEvents
    | where TimeGenerated > ago(1h)
    | where (InitiatingProcessFileName has_any ("ccm", "cucmd", "ucmuser", "tomcat") 
             or InitiatingProcessFolderPath has_any ("/usr/local/cm/", "/opt/cisco/", "C:\\Program Files\\Cisco\\"))
       and FileName in~ ("sh", "bash", "cmd.exe", "powershell.exe", "python", "perl", "wget", "curl", "nc")
    | extend ThreatIndicator = "Cisco UCM process spawned shell (code injection post-exploitation)", SourceAddress = ""
    | project TimeGenerated, DeviceName, InitiatingProcessFileName, FileName, ProcessCommandLine, ThreatIndicator;
  // Union all branches
  union isfuzzy=true CiscoUCMWebAttack, CiscoUCMSyslog, CiscoUCMProcessExec
  | sort by TimeGenerated desc

entityMappings:
  - entityType: Host
    fieldMappings:
      - identifier: HostName
        columnName: DeviceName
  - entityType: IP
    fieldMappings:
      - identifier: Address
        columnName: SourceAddress
  - entityType: URL
    fieldMappings:
      - identifier: Url
        columnName: RequestURL

alertDetailsOverride:
  alertDisplayNameFormat: "Cisco UCM Code Injection Indicator (CVE-2026-20045) on {{DeviceName}}"
  alertDescriptionFormat: "{{ThreatIndicator}} on {{DeviceName}}"

customDetails:
  VulnID: "CVE-2026-20045"
  AffectedProducts: "Cisco Unified CM, Unified CM SME, IM&P, Unity Connection, Webex Calling DI"
  KEVAdded: "2026-01-21"
  VulnType: "Code Injection / Remote Code Execution"

version: 1.0.0
kind: Scheduled
