id: 9dcad799-dff2-4cb8-876f-effd3273486a
name: Microsoft February 2026 Patch Tuesday Exploitation Indicators
description: |
  Detects behavioral indicators associated with active exploitation of Microsoft February 2026
  Patch Tuesday vulnerabilities, including:
  - CVE-2026-21513: MSHTML Framework Protection Mechanism Failure (security feature bypass via network)
  - CVE-2026-21510: Windows Shell Protection Mechanism Failure (security feature bypass via network)
  - CVE-2026-21519: Desktop Window Manager (DWM) Type Confusion (local privilege escalation)
  - CVE-2026-21533: Windows Remote Desktop Services Improper Privilege Management (local LPE)
  - CVE-2026-21514: Microsoft Office Word Reliance on Untrusted Inputs (local LPE)

  The query looks for:
  1. MSHTML/mshta.exe spawning suspicious child processes (CVE-2026-21513 exploitation pattern)
  2. Windows Shell (explorer.exe) spawning scripting engines unexpectedly (CVE-2026-21510)
  3. DWM process (dwm.exe) crashes followed by privilege escalation events (CVE-2026-21519)
  4. RDS/TermService-related privilege escalation (CVE-2026-21533)
  5. Office Word spawning network-connected or scripting child processes (CVE-2026-21514)

severity: High
status: Available
requiredDataConnectors:
  - connectorId: MicrosoftDefenderAdvancedThreatProtection
    dataTypes:
      - DeviceProcessEvents
      - DeviceEvents
  - connectorId: SecurityEvents
    dataTypes:
      - SecurityEvent

queryFrequency: 1h
queryPeriod: 1h

triggerOperator: gt
triggerThreshold: 0

tactics:
  - Execution
  - PrivilegeEscalation
  - DefenseEvasion

relevantTechniques:
  - T1059
  - T1068
  - T1548

query: |
  // CVE-2026-21513 / CVE-2026-21510: MSHTML or Shell spawning suspicious children
  let MshtmlExploit = DeviceProcessEvents
    | where TimeGenerated > ago(1h)
    | where (
        // mshta.exe spawning script interpreters or downloaders
        (InitiatingProcessFileName =~ "mshta.exe" and FileName in~ ("powershell.exe", "cmd.exe", "wscript.exe", "cscript.exe", "bitsadmin.exe", "certutil.exe", "regsvr32.exe", "rundll32.exe", "wmic.exe"))
        // Browser-like processes spawning via MSHTML
        or (InitiatingProcessFileName in~ ("iexplore.exe", "microsoftedgecp.exe") and FileName in~ ("powershell.exe", "cmd.exe", "wscript.exe", "cscript.exe", "regsvr32.exe"))
        // Windows Shell exploitation — explorer spawning scripting engines with network args
        or (InitiatingProcessFileName =~ "explorer.exe" and FileName in~ ("wscript.exe", "cscript.exe", "mshta.exe") and ProcessCommandLine has_any ("http://", "https://", "\\\\"))
      )
    | extend CVE = "CVE-2026-21513/CVE-2026-21510", ThreatType = "MSHTML/Shell Security Bypass"
    | project TimeGenerated, DeviceName, AccountName, InitiatingProcessFileName, FileName, ProcessCommandLine, CVE, ThreatType;
  // CVE-2026-21519: DWM Type Confusion — dwm.exe followed by unexpected child or token impersonation
  let DWMExploit = DeviceProcessEvents
    | where TimeGenerated > ago(1h)
    | where InitiatingProcessFileName =~ "dwm.exe"
      and FileName !in~ ("dwm.exe", "conhost.exe", "WerFault.exe")
    | extend CVE = "CVE-2026-21519", ThreatType = "DWM Type Confusion LPE"
    | project TimeGenerated, DeviceName, AccountName, InitiatingProcessFileName, FileName, ProcessCommandLine, CVE, ThreatType;
  // CVE-2026-21533: RDS Privilege Escalation — TermService/svchost spawning privileged processes
  let RDSExploit = DeviceProcessEvents
    | where TimeGenerated > ago(1h)
    | where InitiatingProcessFileName =~ "svchost.exe"
      and InitiatingProcessCommandLine has_any ("termsvcs", "TermService", "SessionEnv")
      and FileName in~ ("cmd.exe", "powershell.exe", "net.exe", "net1.exe", "whoami.exe", "wmic.exe")
    | extend CVE = "CVE-2026-21533", ThreatType = "RDS Improper Privilege Management LPE"
    | project TimeGenerated, DeviceName, AccountName, InitiatingProcessFileName, FileName, ProcessCommandLine, CVE, ThreatType;
  // CVE-2026-21514: Office Word spawning suspicious children (LPE via untrusted inputs)
  let WordExploit = DeviceProcessEvents
    | where TimeGenerated > ago(1h)
    | where InitiatingProcessFileName =~ "winword.exe"
      and FileName in~ ("powershell.exe", "cmd.exe", "wscript.exe", "cscript.exe", "mshta.exe", "regsvr32.exe", "rundll32.exe", "certutil.exe", "bitsadmin.exe")
    | extend CVE = "CVE-2026-21514", ThreatType = "Office Word Untrusted Input LPE"
    | project TimeGenerated, DeviceName, AccountName, InitiatingProcessFileName, FileName, ProcessCommandLine, CVE, ThreatType;
  // Union all findings
  union isfuzzy=true MshtmlExploit, DWMExploit, RDSExploit, WordExploit
  | sort by TimeGenerated desc

entityMappings:
  - entityType: Host
    fieldMappings:
      - identifier: HostName
        columnName: DeviceName
  - entityType: Account
    fieldMappings:
      - identifier: Name
        columnName: AccountName
  - entityType: Process
    fieldMappings:
      - identifier: CommandLine
        columnName: ProcessCommandLine

alertDetailsOverride:
  alertDisplayNameFormat: "Feb 2026 Patch Tuesday Exploit Indicator — {{ThreatType}} on {{DeviceName}}"
  alertDescriptionFormat: "Detected {{CVE}} exploitation behavior: {{InitiatingProcessFileName}} → {{FileName}} on {{DeviceName}}"

version: 1.0.0
kind: Scheduled
