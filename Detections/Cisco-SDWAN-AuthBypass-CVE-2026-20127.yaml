id: 51b2e29d-733e-408d-b7c0-3a118bf57744
name: Cisco Catalyst SD-WAN Controller/Manager Authentication Bypass (CVE-2026-20127)
description: |
  Detects indicators of exploitation of CVE-2026-20127, an authentication bypass vulnerability
  in Cisco Catalyst SD-WAN Controller (formerly vSmart) and SD-WAN Manager (formerly vManage).
  A broken peering authentication mechanism allows unauthenticated remote attackers to log in as
  a high-privileged internal user account, gaining access to NETCONF and the ability to
  manipulate SD-WAN fabric configuration.

  CISA Emergency Directive 26-03 mandates immediate remediation. Due date: 2026-02-27.

  Detection surfaces:
  - CommonSecurityLog: Cisco SD-WAN syslog/CEF events showing unusual auth or NETCONF sessions
  - Syslog: vManage/vSmart process-level log entries
  - DeviceNetworkEvents/AzureNetworkAnalytics: NETCONF (TCP 830) connections from unexpected sources

  Reference: https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-sdwan-rpa-EHchtZk
severity: High
requiredDataConnectors:
  - connectorId: CommonSecurityLog
    dataTypes:
      - CommonSecurityLog
  - connectorId: Syslog
    dataTypes:
      - Syslog
  - connectorId: MicrosoftDefenderAdvancedThreatProtection
    dataTypes:
      - DeviceNetworkEvents
queryFrequency: 1h
queryPeriod: 1h
triggerOperator: gt
triggerThreshold: 0
tactics:
  - InitialAccess
  - Persistence
  - PrivilegeEscalation
relevantTechniques:
  - T1078
  - T1556
  - T1098
query: |
  union isfuzzy=true
  (
      CommonSecurityLog
      | where DeviceVendor has_any ("Cisco")
      | where DeviceProduct has_any ("SD-WAN", "vManage", "vSmart", "Catalyst SD-WAN", "SDWAN")
      | where Activity has_any ("login", "authentication", "session", "netconf", "config", "audit", "peering")
          or Message has_any ("netconf", "peering", "privileged user", "admin", "authentication bypass",
                               "non-root", "high-privilege", "configuration change", "vmanage_admin")
      | where EventOutcome !in~ ("failed", "failure", "denied", "reject", "blocked")
      | extend AccountName = SourceUserName
      | extend TargetDevice = DeviceAddress
      | project TimeGenerated, DeviceVendor, DeviceProduct, Activity, Message,
                SourceIP, DestinationIP, AccountName, TargetDevice, EventOutcome,
                AdditionalExtensions, LogSeverity
  ),
  (
      Syslog
      | where ProcessName has_any ("vmanage", "vdaemon", "vsmart", "vcontrollerd", "netconfhd",
                                    "netconf", "vshell", "sdwan")
      | where SyslogMessage has_any ("netconf", "peering", "privileged", "admin", "authentication",
                                      "config", "vmanage_admin", "non-root user")
      | project TimeGenerated, Computer, ProcessName, SyslogMessage, HostIP, Facility, SeverityLevel
  ),
  (
      DeviceNetworkEvents
      | where RemotePort == 830  // NETCONF standard port
      | where ActionType == "ConnectionSuccess"
      | extend AccountName = InitiatingProcessAccountName
      | project TimeGenerated, DeviceName, RemoteIP, RemotePort, LocalIP, LocalPort,
                InitiatingProcessFileName, InitiatingProcessCommandLine, AccountName
  )
  | extend CVE = "CVE-2026-20127"
  | extend DetectionContext = "Cisco Catalyst SD-WAN Auth Bypass â€“ CISA ED-26-03"
version: 1.0.0
kind: Scheduled
