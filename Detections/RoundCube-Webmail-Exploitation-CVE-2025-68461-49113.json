{
  "name": "RoundCube Webmail Exploitation Attempt (CVE-2025-68461 / CVE-2025-49113)",
  "description": "Detects exploitation attempts targeting RoundCube Webmail. CVE-2025-68461 is a stored XSS via SVG animate tags, and CVE-2025-49113 is a deserialization RCE via the _from parameter in upload.php. Both were added to the CISA KEV catalog on 2026-02-20. RoundCube is widely used in government and enterprise environments and has been targeted by APT28 and other state actors. This rule looks for suspicious HTTP patterns against RoundCube endpoints in network/proxy logs.",
  "severity": "High",
  "tactics": ["InitialAccess", "Execution"],
  "techniques": ["T1190", "T1059"],
  "requiredDataConnectors": ["AzureFirewall", "CommonSecurityLog", "Zscaler"],
  "query": "// RoundCube Webmail Exploitation Attempt\n// Covers CVE-2025-68461 (XSS via SVG animate) and CVE-2025-49113 (Deserialization RCE via _from param)\nlet timeframe = 1h;\nlet roundcube_xss_patterns = dynamic(['<animate', 'SVG', 'onbegin=', 'onend=']);\nlet roundcube_rce_patterns = dynamic(['/upload.php', '_from=', 'settings/upload']);\n// Check CommonSecurityLog (Proxy/Firewall)\nCommonSecurityLog\n| where TimeGenerated >= ago(timeframe)\n| where RequestURL has_any ('/roundcube', '/webmail', '/rcmail')\n  or DestinationHostName has_any ('roundcube', 'webmail')\n| where RequestURL has_any (roundcube_rce_patterns)\n   or RequestURL matches regex @'[?&]_from='\n   or AdditionalExtensions has_any (roundcube_xss_patterns)\n| extend AttackType = case(\n    RequestURL has '/upload.php' or RequestURL matches regex @'[?&]_from=', 'CVE-2025-49113 - Deserialization RCE',\n    AdditionalExtensions has '<animate', 'CVE-2025-68461 - SVG XSS',\n    'RoundCube Suspicious Request'\n  )\n| project TimeGenerated, SourceIP, DestinationIP, DestinationHostName, RequestURL, AttackType, DeviceVendor, DeviceProduct\n| union (\n    // Check AzureFirewall logs\n    AzureDiagnostics\n    | where Category == 'AzureFirewallApplicationRule' or Category == 'AzureFirewallNetworkRule'\n    | where TimeGenerated >= ago(timeframe)\n    | where requestUrl_s has_any ('/roundcube', '/webmail', '/rcmail')\n      and (requestUrl_s has '/upload.php' or requestUrl_s matches regex @'[?&]_from=')\n    | extend SourceIP = srcIp_s, DestinationIP = dstIp_s, RequestURL = requestUrl_s\n    | extend AttackType = 'CVE-2025-49113 - Deserialization RCE'\n    | project TimeGenerated, SourceIP, DestinationIP, DestinationHostName = '', RequestURL, AttackType, DeviceVendor = 'Azure', DeviceProduct = 'AzureFirewall'\n)\n| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), RequestCount = count(), Requests = make_set(RequestURL, 10)\n    by SourceIP, AttackType\n| where RequestCount >= 1\n| extend AlertSeverity = 'High'\n| sort by RequestCount desc",
  "queryFrequency": "PT1H",
  "queryPeriod": "PT1H",
  "triggerOperator": "GreaterThan",
  "triggerThreshold": 0,
  "entityMappings": [
    {
      "entityType": "IP",
      "fieldMappings": [{ "identifier": "Address", "columnName": "SourceIP" }]
    }
  ],
  "incidentConfiguration": {
    "createIncident": true,
    "groupingConfiguration": {
      "enabled": true,
      "reopenClosedIncident": false,
      "lookbackDuration": "PT5H",
      "matchingMethod": "Selected",
      "groupByEntities": ["IP"]
    }
  },
  "source": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-68461",
    "https://nvd.nist.gov/vuln/detail/CVE-2025-49113"
  ],
  "created": "2026-02-20",
  "version": "1.0.0"
}
